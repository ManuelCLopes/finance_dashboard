<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Finance Dashboard</title>
    {% load static %}

    <!-- Inline script to set initial theme -->
    <script>
        const currentTheme = localStorage.getItem('theme') || 'light';
        document.documentElement.setAttribute('data-theme', currentTheme);
    </script>

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    
    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="{% static 'qrscanner/styles.css' %}">
</head>
<body>
    <!-- Main container -->
    <div class="container py-5 content">
        <div class="theme-toggle">
            <label class="switch">
                <input type="checkbox" id="theme-switch">
                <span class="slider">
                    <i class="fas fa-sun"></i>
                    <i class="fas fa-moon"></i>
                </span>
            </label>
        </div>
        
        <!-- QR Code Section -->
        <div id="qr-code-container" class="text-center mb-5">
            <h2 class="display-4 fw-bold">Finance Dashboard</h2>
            <img src="{% url 'generate_qr_code' %}" alt="QR Code" class="img-fluid my-4" style="max-width: 200px;">
            <p class="lead">Scan this QR code to upload your financial data.</p>
        </div>
        
        <!-- Main Content Section -->
        <div id="main-content" class="d-flex flex-wrap">
            <!-- Selected Chart and Table Section -->
            <div id="selected-chart-table-container" class="d-flex" style="display:none; flex-wrap: nowrap; width:100%;">
                <!-- Placeholder for the Selected Chart -->
                <div id="selected-chart-container" class="flex-grow-1 col-5"></div>
                <!-- Data Table Section -->
                <div id="data-table-container" class="col-7" style="display:none;">
                    <table id="table-container"class="table table-striped">
                        <thead>
                            <tr id="table-headers">
                                <!-- Dynamically filled headers -->
                            </tr>
                        </thead>
                        <tbody id="table-body">
                            <!-- Dynamically filled data rows -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Charts Section -->
            <div id="charts-container" style="display:none;" class="flex-grow-1">
                <div class="grid-container">
                    <!-- Chart Cards -->
                    <div class="chart-card" data-chart="expensesChart" data-table="expenses">
                        <div class="card h-100 shadow-sm">
                            <div class="card-header text-center">
                                <h3 class="card-title">Expenses Breakdown</h3>
                            </div>
                            <div class="card-body">
                                <div class="grid-item">
                                    <canvas id="expensesChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Expenses Distribution -->
                    <div class="chart-card" data-chart="expensesPieChart" data-table="expenses">
                        <div class="card h-100 shadow-sm">
                            <div class="card-header text-center">
                                <h3 class="card-title">Expenses Distribution</h3>
                            </div>
                            <div class="card-body">
                                <div class="grid-item">
                                    <canvas id="expensesPieChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Income Overview -->
                    <div class="chart-card" data-chart="incomesChart" data-table="incomes">
                        <div class="card h-100 shadow-sm">
                            <div class="card-header text-center">
                                <h3 class="card-title">Income Overview</h3>
                            </div>
                            <div class="card-body">
                                <div class="grid-item">
                                    <canvas id="incomesChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Income Over Time -->
                    <div class="chart-card" data-chart="incomeLineChart" data-table="incomes">
                        <div class="card h-100 shadow-sm">
                            <div class="card-header text-center">
                                <h3 class="card-title">Income Over Time</h3>
                            </div>
                            <div class="card-body">
                                <div class="grid-item">
                                    <canvas id="incomeLineChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Investments Breakdown -->
                    <div class="chart-card" data-chart="investmentsChart" data-table="investments">
                        <div class="card h-100 shadow-sm">
                            <div class="card-header text-center">
                                <h3 class="card-title">Investments Breakdown</h3>
                            </div>
                            <div class="card-body">
                                <div class="grid-item">
                                    <canvas id="investmentsChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Investment Types -->
                    <div class="chart-card" data-chart="investmentsStackedBarChart" data-table="investments">
                        <div class="card h-100 shadow-sm">
                            <div class="card-header text-center">
                                <h3 class="card-title">Investment Types</h3>
                            </div>
                            <div class="card-body">
                                <div class="grid-item">
                                    <canvas id="investmentsStackedBarChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer>
        <div class="container text-center py-3">
            <p><a href="{% url 'privacy_policy' %}">Privacy Policy</a></p>
        </div>
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Custom JavaScript for Chart Initialization -->
    <script src="{% static 'qrscanner/charts.js' %}"></script>
</body>
</html>
